{% extends 'blog/blog_type_base.html' %}
{% block content %}


<div class="row">
    <a href="{{ url_for('blog.index_num') }}">返回首页</a>
    <table style="width:100%;">
        <tr>
            <td align="center">
                <h2>{{ page.Title }}</h2>
            </td>
        </tr>
        <tr>
            <td align="right">
                {{ page.Date  }} <br />
                {% for tag in page.Tags %}
                <span class="label label-primary" >
                    <a href="{{ url_for('blog.tag_num',tag=tag) }}" style="color:#fff;">{{ tag }}</a>
                </span>
                &nbsp
                {% endfor %}
            </td>
        </tr>
        <tr>
            <td>
                <div style="border-bottom:1px dashed #000000;width:100%;"></div>
            </td>
        </tr>
    </table>
    <div width="100%" style="padding:0 4%;" >
        <p>
        {{ page.html|safe }}
        </p>
    </div>
    <div>
        <nav>
            <ul class="pager">
                {% if page_previous %}
                <li class="previous"><a href="{{ url_for('blog.page',path=page_previous.path) }}"><span aria-hidden="true">&larr;</span>上一篇:{{ page_previous['Title'] }}</a></li>
                {% else %}
                <li class="previous"><a href="#"><span aria-hidden="true">&larr;</span>上一篇:这已经是第一篇</a></li>
                {% endif %}
                {% if page_next %}
                <li class="next"><a href="{{ url_for('blog.page',path=page_next.path) }}">下一篇:{{ page_next['Title'] }}<span aria-hidden="true">&rarr;</span></a></li>
                {% else %}
                <li class="next"><a href="#">下一篇:没有了<span aria-hidden="true">&rarr;</span></a></li>
                {% endif %}
                <li> <a href="#">返回顶部</a></li>
            </ul>
        </nav>
    </div>
</div>
<div class="panel panel-default" id="#comment">
    <div class="panel-heading">评论</div>
    <div class="panel-body">
        <form action="{{ url_for('blog.comment',path=path) }}" method="POST">
            {{ form.hidden_tag()}}
            {{ form.comment(class="form-control",placeholder="写下你的评论" ,style="height:80px;") }}
            <br />
            {{ form.post_comment(class="btn btn-primary") }}
        </form>
    </div>
    <div class="panel panel-info">
        {% set i = 0 %}
        {% for comment in all_comment %}
        <div class="panel-heading">
            {{ comment['comment_user'] }}于
            {{ comment['comment_publish'] }}发表:
        </div>
        <div class="panel-body">
            {{ comment['comment_content'] }}
            <br />
            <a class="btn btn-primary btn-sm" role="button" data-toggle="collapse" href="#reply{{ i }}" aria-expanded="false" aria-controls="reply{{ i }}">
                查看并回复此评论
            </a>
            <div class="collapse" id="reply{{ i }}">
                <div class="panel panel-info">
                    {% for reply in comment['reply'] %} 
                    <div class="panel-heading" style="padding:0 10px;">
                        {{ reply['reply_user'] }}于
                        {{ reply['reply_publish'] }}回复:
                    </div>
                    <div class="panel-body">
                        {{ reply['reply_content'] }}
                    </div>
                    {% endfor %}
                    <form action="{{ url_for('blog.reply',path=path,
                    comment_id=comment['id']) }}" method="POST">
                        {{ form.hidden_tag()}}
                        {{ form.reply(class="form-control",placeholder="写下你的回复" ,style="height:80px;") }}
                        <br />
                        {{ form.post_reply(class="btn btn-primary btn-sm") }}
                    </form>
                </div>
            </div>
            {% set i=i+1 %}
        </div>
        {% endfor %}
    </div>
    {% endblock content %}
